# Telegraf Opentelemetry Metrics on AWS Fargate

## Create IAM User Group (if needed)
1. User group name: Microservices
2. Attach permissions policies - Optional: AdministratorAccess

## Create IAM User (if needed)
1. User name: DavGeoAnd
2. Provide user access to the AWS Management Console - optional: Check
    * User type: I want to create an IAM user
3. Console password: Autogenerated password
4. Users must create a new password at next sign-in - Recommended: Uncheck
5. Permissions options: Add user to group
    * User groups: Microservices
6. Console sign-in: https://dave-aws-dga.signin.aws.amazon.com/console
7. Sign in with IAM user

## Create ECR Repository
1. 'Visibility settings': Private
2. 'Repository name': telegraf-otel-metrics

## Create Cluster (if needed)
1. Cluster name: dga-microservices
2. Infrastructure: AWS Fargate (serverless)

## Create Task Definition
1. Task definition family: telegraf-otel-metrics
2. Launch type: AWS Fargate
3. Task size
    * CPU: .25 vCPU
    * Memory: .5 GB
4. Container - 1
    * Name: telegraf-otel-metrics
    * Image URI: 396607284401.dkr.ecr.us-east-1.amazonaws.com/telegraf-otel-metrics:1.27.4-5764a64
    * Port mappings: 4317

## Create Cloud Map Namespace
1. Namespace name: dga-monitoring
2. Instance discovery: API calls and DNS queries in VPCs
3. VPC: dga-vpc

## Create Service in ECS
1. Existing cluster: dga-microservices
2. Compute options: Launch type
3. Service name: telegraf-otel-metrics
4. Service Connect
   * Check Turn on Service Connect
   * Service Connect configuration: Client side only
   * Namespace: dga-microservices
5. Subnets
   * 1a, 1b
6. Security group: dga-otel-ecs-sg
   * Security group name: dga-otel-ecs-sg
   * Security group description: open ports for dga opentelemetry tools on ecs fargate
   * Inbound rules for security groups
      * Type: Custom TCP --- Port range: 4317 --- Source: Anywhere

## Create service in Cloud Map
1. Service name: telegraf-otel-metrics
2. TTL: 60
3. Register Service
   *